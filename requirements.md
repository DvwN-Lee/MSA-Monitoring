# Cloud-Native 마이크로서비스 플랫폼 요구사항 명세서

**문서 버전**: 1.0  
**작성일**: 2025년 9월 29일

---

## 1. 프로젝트 개요

### 1.1. 프로젝트 목적
기존 로컬 환경에서 개발된 마이크로서비스 기반 블로그 플랫폼(v1.0)의 한계를 극복하고, 클라우드 네이티브 기술 스택을 적용하여 프로덕션 수준의 운영 경험을 갖춘 포트폴리오를 완성하는 것을 목적으로 한다.

### 1.2. 프로젝트 범위
- **In-Scope (범위 내)**: AWS EKS 환경에 마이크로서비스 배포, Terraform을 통한 인프라 코드화, GitOps 기반의 CI/CD 파이프라인 구축, Service Mesh 및 관측성 시스템 도입.
- **Out-of-Scope (범위 외)**: 멀티 클러스터/멀티 리전 구성, Blue/Green 배포 전략, 애플리케이션의 새로운 비즈니스 기능 추가.

---

## 2. 현재 상태 (v1.0) 및 문제점

### 2.1. 현재 아키텍처
- 로컬 쿠버네티스(Minikube/Kind) 환경에서 동작하는 6개의 마이크로서비스(API Gateway, Load Balancer, Auth, User, Blog, Dashboard).
- Kustomize 기반의 매니페스트 관리 및 Skaffold를 이용한 개발 환경 배포.
- 데이터 저장소로 SQLite와 Redis를 사용.

### 2.2. 문제점
- **클라우드 운영 경험 부재**: 실제 클라우드 환경에서의 배포, 운영, 트러블슈팅 경험이 없음.
- **수동 인프라 관리**: 인프라가 코드로 관리되지 않아(No IaC), 환경을 재생산하거나 변경하기 어려움.
- **자동화된 파이프라인 부재**: CI/CD 파이프라인이 없어 모든 빌드와 배포를 수동으로 진행함.
- **프로덕션급 기능 부재**: 서비스 메시, 중앙 로깅, 분산 추적 등 현대적인 클라우드 네이티브 기능이 없음.
- **확장성 한계**: 파일 기반 데이터베이스(SQLite) 사용으로 서비스의 수평 확장이 불가능함.

---

## 3. 기능 요구사항 (Functional Requirements)

MoSCoW 우선순위 기법에 따라 요구사항을 분류한다.

### 3.1. Must-Have (필수 요구사항)
- **FR-M-1: IaC 기반 인프라 구축**: Terraform 코드를 통해 AWS VPC, EKS 클러스터 및 관련 네트워킹 리소스를 생성할 수 있어야 한다.
- **FR-M-2: 자동화된 CI/CD 파이프라인**: Git `main` 브랜치에 코드가 푸시되면, 자동으로 린트, 단위 테스트, 보안 스캔, 컨테이너 이미지 빌드 및 ECR 푸시, Argo CD를 통한 자동 배포가 수행되어야 한다.
- **FR-M-3: 관계형 데이터베이스 영속성**: 파일 기반 DB를 PostgreSQL로 교체하여, 데이터가 영속적으로 저장되고 서비스의 수평 확장이 가능해야 한다.
- **FR-M-4: 핵심 지표 모니터링**: Prometheus와 Grafana를 통해 시스템의 Golden Signals(Latency, Traffic, Errors, Saturation)을 시각적으로 모니터링할 수 있어야 한다.
- **FR-M-5: 기본 애플리케이션 기능**: 기존의 사용자 인증(JWT) 및 블로그 CRUD 기능이 정상적으로 동작해야 한다.

### 3.2. Should-Have (중요 요구사항)
- **FR-S-1: 서비스 간 통신 암호화**: Istio를 사용하여 모든 마이크로서비스 간의 통신이 mTLS로 자동 암호화되어야 한다.
- **FR-S-2: 중앙화된 로그 수집**: 모든 서비스에서 발생하는 로그를 Loki를 통해 한곳에서 수집하고 Grafana를 통해 검색 및 조회할 수 있어야 한다.
- **FR-S-3: API 요청 제한**: Go로 구현된 API Gateway에 Token Bucket 알고리즘 기반의 Rate Limiter를 적용하여 초당 요청 수를 제한할 수 있어야 한다.

### 3.3. Could-Have (선택 요구사항)
- **FR-C-1: 점진적 배포**: Istio의 트래픽 제어 기능을 사용하여 Canary 배포를 수행할 수 있어야 한다.
- **FR-C-2: 분산 추적**: Jaeger를 도입하여 서비스 간 호출 흐름을 시각적으로 추적할 수 있어야 한다.
- **FR-C-3: 자동 확장**: CPU 사용량에 따라 서비스 Pod의 개수가 자동으로 증가하거나 감소(HPA)해야 한다.

---

## 4. 비기능 요구사항 (Non-Functional Requirements)

- **NFR-1: 성능**:
  - **측정 조건**: k6 부하 테스트 도구를 사용하여 100 RPS(초당 요청 수)를 5분간 지속했을 때, 주요 API 엔드포인트의 P95 응답 시간이 500ms 미만이어야 한다.
  - **측정 도구**: Prometheus + Grafana
- **NFR-2: 확장성**:
  - **측정 조건**: 부하 발생 시 CPU 사용률이 70%를 초과하면 Pod의 개수가 1분 이내에 자동으로 증가해야 한다. (HPA 설정)
- **NFR-3: 가용성**:
  - **목표**: 시스템 가용률 99% (월간 장애 시간 7.2시간 미만)
  - **측정 조건**: Pod 재시작 또는 노드 장애 발생 시 5분 이내에 서비스가 자동으로 복구되어야 한다. (Argo CD 자동 롤백 및 K8s 자체 복구 기능)
- **NFR-4: 보안**:
  - **조건 1**: CI 파이프라인에서 Trivy 스캔을 통해 `HIGH`, `CRITICAL` 등급의 컨테이너 이미지 취약점이 발견되지 않아야 한다.
  - **조건 2**: 외부에서 클러스터 내부로 들어오는 모든 트래픽은 HTTPS로 암호화되어야 한다.
  - **조건 3**: 서비스 간 통신은 Istio mTLS를 통해 암호화되어야 한다.
- **NFR-5: 비용**:
  - **조건**: AWS 월별 청구 비용이 $50를 초과하지 않아야 한다. AWS Billing Alarms를 통해 모니터링한다.

---

## 5. 제약사항

- **예산**: 월 $50 이하로 모든 클라우드 리소스를 운영해야 한다.
- **인력**: 모든 개발, 운영, 테스트를 1인이 수행한다.
- **기간**: 5주 이내에 Must-Have 요구사항을 모두 완료해야 한다.

---

## 6. 성공 기준 (Acceptance Criteria)

- **Must-Have 완료**: 위 3.1절의 모든 기능 요구사항이 구현되고, 4절의 모든 비기능 요구사항을 충족해야 프로젝트가 성공으로 간주된다.
- **문서화**: README, 아키텍처, ADR 등 주요 프로젝트 문서가 완성되어야 한다.
- **데모**: Git Push부터 EKS 자동 배포까지의 전체 과정을 시연할 수 있어야 한다.